"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[342],{"./src/apollo/cache.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>cache});const cache=new(__webpack_require__("./node_modules/@apollo/client/cache/inmemory/inMemoryCache.js").D)({typePolicies:{User:{fields:{notes:{merge:!0}}}}})},"./src/chunks/(authenticated)/Header/HeaderAuth/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>HeaderAuth});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),useApolloClient=__webpack_require__("./node_modules/@apollo/client/react/hooks/useApolloClient.js"),navigation=__webpack_require__("./node_modules/next/navigation.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),local=__webpack_require__("./src/data/local.ts"),auth=__webpack_require__("./src/data/auth.ts");function HeaderAuth(){const h=function useHeaderAuth(){const router=(0,navigation.useRouter)(),client=(0,useApolloClient.m)(),authUser=(0,auth.ZY)(),[menuVisible,setMenuVisible]=(0,react.useState)(!1);return{authUser,logOut:async()=>{router.push("/login"),await client.resetStore(),await(0,local.Z5)()},menuVisible,toggleMenu:()=>setMenuVisible(!menuVisible)}}();if(h.authUser)return(0,jsx_runtime.jsxs)("div",{className:"relative",children:[h.menuVisible&&(0,jsx_runtime.jsx)("div",{onClick:h.toggleMenu,className:"fixed left-0 top-0 z-10 h-screen w-screen cursor-pointer bg-[#00000088]"}),(0,jsx_runtime.jsx)("button",{onClick:h.toggleMenu,className:"mx-2 grid size-9 place-items-center rounded-full bg-violet-800 font-bold",children:h.authUser.name[0]}),(0,jsx_runtime.jsxs)("div",{role:"menu",className:classnames_default()("absolute right-0 z-20 my-2 w-64 overflow-hidden rounded-lg bg-neutral-700 shadow-lg transition-opacity",h.menuVisible?"h-max":"h-0 opacity-0"),children:[(0,jsx_runtime.jsxs)("div",{className:"border-b border-light p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xl font-bold",children:h.authUser.name}),(0,jsx_runtime.jsx)("div",{className:"text-neutral-400",children:h.authUser.email})]}),(0,jsx_runtime.jsx)("div",{className:"flex flex-col",children:(0,jsx_runtime.jsx)("button",{role:"menuitem",className:"p-4 text-center hover:bg-accent",onClick:h.logOut,children:"Log out"})})]})]})}HeaderAuth.__docgenInfo={description:"",methods:[],displayName:"HeaderAuth"}},"./src/chunks/(authenticated)/Header/MenuTrigger/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>MenuTrigger});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_barrel_optimize_names_MdMenu_react_icons_md__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("__barrel_optimize__?names=MdSearch!=!./node_modules/react-icons/md/index.mjs"),_components_IconButton__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/IconButton/index.tsx"),_data_menu_extended__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/data/menu-extended.ts");function MenuTrigger(){const toggleMenu=(0,_data_menu_extended__WEBPACK_IMPORTED_MODULE_2__.zk)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_IconButton__WEBPACK_IMPORTED_MODULE_1__.A,{title:"Main menu",onClick:toggleMenu,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_MdMenu_react_icons_md__WEBPACK_IMPORTED_MODULE_3__.vIB,{size:24})})}MenuTrigger.__docgenInfo={description:"",methods:[],displayName:"MenuTrigger"}},"./src/chunks/(authenticated)/Header/SearchBox/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>SearchBox});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),md=__webpack_require__("__barrel_optimize__?names=MdSearch!=!./node_modules/react-icons/md/index.mjs"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),search=__webpack_require__("./src/data/search.ts");var IconButton=__webpack_require__("./src/components/IconButton/index.tsx");function SearchBox(props){const h=function useSearchBox(){const[focused,setFocused]=(0,react.useState)(!1),refs={container:(0,react.useRef)(null),input:(0,react.useRef)(null)},value=(0,search.W)(),setValue=(0,search.G)(),focus=()=>{var _refs_input_current;setFocused(!0),null===(_refs_input_current=refs.input.current)||void 0===_refs_input_current||_refs_input_current.focus()};return{events:{onBlur:event=>{var _refs_container_current;(null===(_refs_container_current=refs.container.current)||void 0===_refs_container_current?void 0:_refs_container_current.contains(event.relatedTarget))||setFocused(!1)},onChangeValue:event=>{setValue(event.target.value)}},actions:{blur:()=>setFocused(!1),clearValue:()=>{setValue(""),focus()},focus},focused,refs,value}}();return props.isCompact&&!h.focused?(0,jsx_runtime.jsx)(IconButton.A,{title:"Search",onClick:h.actions.focus,children:(0,jsx_runtime.jsx)(md.gZ7,{size:24})}):(0,jsx_runtime.jsxs)("div",{ref:h.refs.container,className:classnames_default()("inline-flex items-center gap-2 rounded-lg bg-accent px-2","focus-within:bg-white focus-within:text-black",{"absolute left-4 top-4":h.focused&&props.isCompact}),onFocus:h.actions.focus,onBlur:h.events.onBlur,tabIndex:0,children:[(0,jsx_runtime.jsx)("div",{children:props.isCompact?(0,jsx_runtime.jsx)(IconButton.A,{title:"Close search",className:"p-2",onClick:h.actions.blur,children:(0,jsx_runtime.jsx)(md.MGo,{size:24})}):(0,jsx_runtime.jsx)(IconButton.A,{title:"Search",className:"p-2",onClick:h.actions.focus,children:(0,jsx_runtime.jsx)(md.gZ7,{size:24})})}),(0,jsx_runtime.jsx)("input",{ref:h.refs.input,value:null!==(_h_value=h.value)&&void 0!==_h_value?_h_value:"",onChange:h.events.onChangeValue,className:"bg-transparent py-3 focus:outline-none",placeholder:"Search",autoFocus:!0}),h.focused&&(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(IconButton.A,{title:"Clear search",className:"p-2",onClick:h.actions.clearValue,children:(0,jsx_runtime.jsx)(md.m6K,{size:24})})})]});var _h_value}SearchBox.__docgenInfo={description:"",methods:[],displayName:"SearchBox",props:{isCompact:{required:!1,tsType:{name:"boolean"},description:"Whether it is in compact mode (mobile version) or not."}}}},"./src/chunks/(authenticated)/Header/stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,default:()=>stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),HeaderAuth=__webpack_require__("./src/chunks/(authenticated)/Header/HeaderAuth/index.tsx"),MenuTrigger=__webpack_require__("./src/chunks/(authenticated)/Header/MenuTrigger/index.tsx"),SearchBox=__webpack_require__("./src/chunks/(authenticated)/Header/SearchBox/index.tsx");function Header(){return(0,jsx_runtime.jsxs)("header",{className:"flex items-center justify-between border-b border-light p-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-4 md:gap-12",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-4",children:[(0,jsx_runtime.jsx)(MenuTrigger.A,{}),(0,jsx_runtime.jsx)("h1",{className:"text-xl",children:"MyKeep"})]}),(0,jsx_runtime.jsx)("div",{className:"hidden md:inline-block",children:(0,jsx_runtime.jsx)(SearchBox.A,{})}),(0,jsx_runtime.jsx)("div",{className:"md:hidden",children:(0,jsx_runtime.jsx)(SearchBox.A,{isCompact:!0})})]}),(0,jsx_runtime.jsx)(HeaderAuth.A,{})]})}Header.__docgenInfo={description:"",methods:[],displayName:"Header"};const Primary={},stories={component:Header,tags:["autodocs"],parameters:{layout:"fullscreen"},decorators:[Story=>(0,jsx_runtime.jsx)("div",{className:"h-64",children:(0,jsx_runtime.jsx)(Story,{})})]}},"./src/data/auth.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CR:()=>useRegisterUser,ZY:()=>useAuthUser,vz:()=>useLogin});var _apollo_client__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@apollo/client/react/hooks/useQuery.js"),_apollo_client__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@apollo/client/react/hooks/useMutation.js"),_data_gql_auth__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/data/gql/auth.ts");function useAuthUser(){var _res_data;return null===(_res_data=(0,_apollo_client__WEBPACK_IMPORTED_MODULE_1__.I)(_data_gql_auth__WEBPACK_IMPORTED_MODULE_0__.Jd).data)||void 0===_res_data?void 0:_res_data.authUser}function useLogin(){const[mutation]=(0,_apollo_client__WEBPACK_IMPORTED_MODULE_2__.n)(_data_gql_auth__WEBPACK_IMPORTED_MODULE_0__.bd);return async credentials=>mutation({variables:{credentials}})}function useRegisterUser(){const[mutation]=(0,_apollo_client__WEBPACK_IMPORTED_MODULE_2__.n)(_data_gql_auth__WEBPACK_IMPORTED_MODULE_0__.V5);return async user=>mutation({variables:{user}})}},"./src/data/local.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{NE:()=>setLocalItem,Z5:()=>clearLocalItems,nR:()=>getLocalItem});var idb_keyval__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/idb-keyval/dist/index.js");async function getLocalItem(key){return idb_keyval__WEBPACK_IMPORTED_MODULE_0__.Jt(key)}async function setLocalItem(key,val){return idb_keyval__WEBPACK_IMPORTED_MODULE_0__.hZ(key,val)}async function clearLocalItems(){return idb_keyval__WEBPACK_IMPORTED_MODULE_0__.IU()}},"./src/data/menu-extended.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$g:()=>useExtendMenu,St:()=>useIsMenuExtended,zk:()=>useToggleMenu});var _swc_helpers_tagged_template_literal__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@swc/helpers/esm/_tagged_template_literal.js"),_apollo_client__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/graphql-tag/lib/index.js"),_apollo_client__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@apollo/client/react/hooks/useQuery.js"),_apollo_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apollo/cache.ts");function _templateObject(){const data=(0,_swc_helpers_tagged_template_literal__WEBPACK_IMPORTED_MODULE_0__._)(["\n  query GetMenuExtended {\n    menuExtended @client\n  }\n"]);return _templateObject=function(){return data},data}const GetMenuExtendedQuery=(0,_apollo_client__WEBPACK_IMPORTED_MODULE_2__.J1)(_templateObject());function useIsMenuExtended(){var _res_data;const res=(0,_apollo_client__WEBPACK_IMPORTED_MODULE_3__.I)(GetMenuExtendedQuery);return Boolean(null===(_res_data=res.data)||void 0===_res_data?void 0:_res_data.menuExtended)}function useExtendMenu(){return menuExtended=>{_apollo_cache__WEBPACK_IMPORTED_MODULE_1__.P.writeQuery({query:GetMenuExtendedQuery,data:{menuExtended}})}}function useToggleMenu(){const isExtended=useIsMenuExtended();return()=>_apollo_cache__WEBPACK_IMPORTED_MODULE_1__.P.writeQuery({query:GetMenuExtendedQuery,data:{menuExtended:!isExtended}})}},"./src/data/search.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>useGetQuery,G:()=>useSetQuery});var useQuery=__webpack_require__("./node_modules/@apollo/client/react/hooks/useQuery.js"),cache=__webpack_require__("./src/apollo/cache.ts"),_tagged_template_literal=__webpack_require__("./node_modules/@swc/helpers/esm/_tagged_template_literal.js"),lib=__webpack_require__("./node_modules/graphql-tag/lib/index.js");function _templateObject(){const data=(0,_tagged_template_literal._)(["\n  query GetQuery {\n    query @client\n  }\n"]);return _templateObject=function(){return data},data}function _templateObject1(){const data=(0,_tagged_template_literal._)(["\n  query SearchQuery($query: String!) {\n    search(query: $query) {\n      content\n    }\n  }\n"]);return _templateObject1=function(){return data},data}const GetSearchQuery=(0,lib.J1)(_templateObject());(0,lib.J1)(_templateObject1());function useGetQuery(){var _res_data;var _res_data_query;return null!==(_res_data_query=null===(_res_data=(0,useQuery.I)(GetSearchQuery).data)||void 0===_res_data?void 0:_res_data.query)&&void 0!==_res_data_query?_res_data_query:""}function useSetQuery(){return query=>cache.P.writeQuery({query:GetSearchQuery,data:{query}})}}}]);